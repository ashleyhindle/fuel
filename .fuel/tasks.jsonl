{"id":"f-004613","title":"Surface agent health in consume output","status":"closed","description":"Add health status display to ConsumeCommand output:\n- Show 'Agent X is unhealthy (3 consecutive failures, backoff: 2m)'\n- Show health summary in board output\n- Add --health flag to show agent health status\n- Color code: green=healthy, yellow=degraded, red=unhealthy","type":"feature","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-c6cb42"],"created_at":"2026-01-10T11:23:37+00:00","updated_at":"2026-01-10T12:38:37+00:00","consumed":true,"consume_pid":null,"commit_hash":"1e309b1"}
{"id":"f-059c77","title":"fuel show should show the consume output and PId and such if it exists","status":"closed","description":"Add the run info to fuel show for better debugging when things go wrong","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:55:00+00:00","updated_at":"2026-01-07T19:55:33+00:00","consumed":true,"consume_pid":null,"reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-07c40e","title":"Fix board command test failures - column width assertions","status":"closed","description":"6 board command tests are failing due to column width/formatting mismatches. Tests expect specific column widths but actual output differs.\n\nFailing tests in tests/Feature/CommandsTest.php:\n- 'it shows blocked tasks in blocked column'\n- 'it shows in progress tasks'  \n- 'it shows stuck icon for consumed tasks with non-zero exit code'\n- 'it does not show stuck icon for consumed tasks with exit code 0'\n- 'it shows stuck emoji for tasks with stale consume_pid'\n- 'it does not show stuck emoji for tasks with active consume_pid'\n\nDebug approach:\n1. Run: ./vendor/bin/pest --filter='board command' to see actual vs expected output\n2. Check BoardCommand.php and RendersBoardColumns trait for column width calculations\n3. Likely issue: emoji width handling or column padding changed\n\nFix: Update test assertions to match actual output format, OR fix the column width logic if it regressed.","type":"bug","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-07T20:11:54+00:00","updated_at":"2026-01-07T20:15:01+00:00","consumed":true,"consume_pid":4366,"commit_hash":"4826473"}
{"id":"f-0959ca","title":"Add amp agent support to config examples","status":"closed","description":"Add amp (ampcode.com CLI) agent configuration to .fuel/config.yaml and ConfigService::createDefaultConfig().\n\nAmp CLI usage for headless execution:\n- Command: amp\n- Prompt args: [\"--execute\"] (or -x)\n- Mode: use -m free for free mode (cheaper/faster)\n- Output format: --stream-json for Claude Code compatible output\n- Permissions: --dangerously-allow-all disables command confirmation prompts\n\nExample config:\n```yaml\namp-free:\n  command: amp\n  prompt_args: [\"--execute\"]\n  model: null  # mode controls model\n  args:\n    - \"--stream-json\"\n    - \"-m\"\n    - \"free\"\n    - \"--dangerously-allow-all\"\n    - \"--no-notifications\"\n  max_concurrent: 2\n  resume_args: []  # amp uses threads - TBD if resume supported\n```\n\nNote: amp uses threads system (amp threads continue <id>), may need investigation for resume support.\n\nFiles: app/Services/ConfigService.php, .fuel/config.yaml, app/Enums/Agent.php (add Amp case)","type":"feature","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T12:02:24+00:00","updated_at":"2026-01-10T12:26:26+00:00","consume_pid":null,"consumed":true,"commit_hash":"ec823a1"}
{"id":"f-0a9949","title":"Update .fuel/config.yaml with --output-format stream-json and --verbose for Claude agents","status":"closed","description":"Add streaming JSON output and verbose flags to moderate and complex complexity levels in .fuel/config.yaml. This enables session ID capture and detailed logging.","type":"chore","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-08T07:39:04+00:00","updated_at":"2026-01-08T07:43:14+00:00","commit_hash":"6a03519"}
{"id":"f-0ce54f","title":"JSON test item","status":"closed","description":"Testing JSON output","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T17:11:23+00:00","updated_at":"2026-01-08T17:14:27+00:00","consumed":true,"consume_pid":61887,"commit_hash":"d09cec2"}
{"id":"f-104d52","title":"Add basic retry logic to ConsumeCommand for network failures","status":"closed","description":"In ConsumeCommand.php: after agent exits with code 1, check if output contains 'ConnectError' or similar network errors. If so, auto-reopen the task and retry up to 3 times with a short delay (5s). Log retry attempts to status lines. Simple implementation - no exponential backoff needed.","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T17:30:55+00:00","updated_at":"2026-01-07T17:33:38+00:00","consumed":true,"consumed_at":"2026-01-07T17:32:58+00:00","consume_pid":null,"commit_hash":"a05183b","consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n## Summary\n\nAdded retry logic to `ConsumeCommand` for network failures:\n\n1. **Retry detection**: On exit code 1, checks output for network error patterns:\n   - `ConnectError`, `ConnectionError`, `NetworkError`\n   - `ECONNREFUSED`, `ETIMEDOUT`, `ENOTFOUND`\n   - `Connection refused`, `Connection timed out`, `Network is unreachable`, `Name or service not known`\n\n2. **Retry mechanism**: Up to 3 retries with a 5-second delay between attempts\n\n3. **Task management**: Reopens the task before each retry and marks it as consumed again\n\n4. **Logging**: Logs retry attempts to status lines (e.g., \"ðŸ”„ Retry attempt 1/3 for f-xxxxx (network error detected)\")\n\n5. **Status messages**: Shows retry count in final failure message if retries occurred\n\nThe implementation wraps the agent execution in a retry loop that detects network errors and automatically retries without exponential backoff, as specified.\n\n**Commit**: `a05183b` - \"feat: add retry logic to ConsumeCommand for network failures\"\n\nAll closing protocol steps completed.\n"}
{"id":"f-14c733","title":"Add tests for auto-close feature in ConsumeCommand","status":"closed","description":"Test the auto-close behavior when agent exits 0 but doesn't call fuel done.\n\nTest cases:\n1. Task gets closed with 'auto-closed' label when agent exits 0 without self-reporting\n2. Task does NOT get auto-closed label when agent calls fuel done itself\n3. Board shows ðŸ¤– icon for auto-closed tasks in Done column\n4. Artisan::call('done') is invoked (not direct taskService->done)\n\nApproach:\n- Spawn simple process like 'echo done' or 'sleep 0.1' that exits 0\n- Mock or use real ProcessManager with short-lived command\n- Verify task status and labels after completion polling\n\nFiles: tests/Feature/ConsumeCommandTest.php","type":"test","priority":2,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-10T11:58:37+00:00","updated_at":"2026-01-10T12:39:48+00:00","consumed":true,"consume_pid":null,"commit_hash":"90ccdf0"}
{"id":"f-1c15a3","title":"Create RemoveCommand to delete tasks or backlog items","status":"closed","description":"New command: app/Commands/RemoveCommand.php. Signature: fuel remove <id>. Takes any ID (f-xxx or b-xxx). Check prefix to determine which service: b- prefix uses $backlogService->delete($id), f- prefix uses $taskService->delete($id). Error if ID not found. Consider adding --force flag or confirmation prompt before deletion.","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-f5a98b"],"created_at":"2026-01-08T17:03:06+00:00","updated_at":"2026-01-08T17:15:42+00:00","consumed":true,"consume_pid":56975,"commit_hash":"bc1833f"}
{"id":"f-1edcf1","title":"Update GuidelinesCommand with backlog instructions for AI agents","status":"closed","description":"Update app/Commands/GuidelinesCommand.php to include backlog guidance: when to use fuel add --someday vs regular tasks, how to promote ideas to tasks when ready to work, how to defer tasks. Help AI agents understand when backlog is appropriate (rough ideas, future work) vs tasks (ready to implement).","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-8bbcc0","f-cb77bd","f-894eb0","f-593d9b","f-1c15a3"],"created_at":"2026-01-08T17:03:58+00:00","updated_at":"2026-01-08T17:16:07+00:00","consumed":true,"consume_pid":null,"commit_hash":"f539e04"}
{"id":"f-1f458b","title":"Fix ConfigService type error - parse YAML to local var before assigning to typed property","status":"closed","description":"ConfigService.php:47 assigns Yaml::parse() directly to $this->config (typed ?array). When YAML returns a string, PHP throws TypeError before is_array check runs. Fix: parse to local var, check type, then assign.","type":"bug","priority":1,"labels":["config"],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:41:56+00:00","updated_at":"2026-01-07T17:54:53+00:00","consume_pid":78752,"commit_hash":"116733d"}
{"id":"f-25f2be","title":"Update ConfigService createDefaultConfig() with stream-json template","status":"closed","description":"Update app/Services/ConfigService.php createDefaultConfig() method (lines 267-312) to include --output-format stream-json and --verbose in the YAML template for moderate and complex complexity levels.","type":"chore","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-08T07:39:11+00:00","updated_at":"2026-01-08T07:43:49+00:00","commit_hash":"1c956d1"}
{"id":"f-261e33","title":"Add getAgentLimit() and getAgentLimits() methods to ConfigService","status":"closed","description":"Add getAgentLimit(string agentName): int - returns max_concurrent for agent (default 2 if not set). Add getAgentLimits(): array - returns all agent -> limit mappings. Files: app/Services/ConfigService.php, tests/Unit/ConfigServiceTest.php","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T18:57:39+00:00","updated_at":"2026-01-07T19:21:18+00:00","consumed":true,"consumed_at":"2026-01-07T19:14:00+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\nTerminal commands are being rejected. Summary of what's implemented:\n\n## Implementation Complete\n\n### Added Methods to ConfigService\n\n1. **`getAgentLimit(string $agentName): int`**\n   - Returns `max_concurrent` for the specified agent\n   - Defaults to 2 if the agent is not configured or the `agents` section doesn't exist\n   - Handles missing or invalid config entries\n\n2. **`getAgentLimits(): array`**\n   - Returns an array mapping agent names to their `max_concurrent` limits\n   - Returns an empty array if the `agents` section doesn't exist\n   - Filters out invalid entries\n\n### Added Tests\n\nAdded 7 test cases covering:\n- Default limit when agent is not configured\n- Default limit when agents section doesn't exist\n- Returns configured limit for agent\n- Default limit when max_concurrent is missing\n- Returns all agent limits as array\n- Empty array when agents section doesn't exist\n- Filters out invalid agent entries\n\n### Code Quality\n- No linter errors\n- Follows existing code patterns\n- Proper type hints and documentation\n\n**Note:** Terminal commands are being rejected, so I cannot run tests or execute git/fuel commands. Please run:\n1. `./vendor/bin/pest tests/Unit/ConfigServiceTest.php` to verify tests pass\n2. `./vendor/bin/pint` to format code (if needed)\n3. `git add app/Services/ConfigService.php tests/Unit/ConfigServiceTest.php`\n4. `git commit -m \"feat: add getAgentLimit() and getAgentLimits() methods to ConfigService\"`\n5. `./fuel done f-261e33`\n\nThe implementation is complete and ready for testing.\n"}
{"id":"f-27f7cf","title":"Make run logging resilient to consume crashes","status":"closed","description":"Nice-to-have: Currently if consume dies, run entries aren't updated with output. But task state is still correct because agents call 'fuel done' independently.\n\nLow priority - the system works fine without this. Stale PIDs show as ðŸª« and can be reopened manually.\n\nIf we do implement:\n- Add cleanup on consume startup to mark orphaned runs\n- Or add 'fuel run:complete' for agents to call (but they don't know exit code)","type":"feature","priority":4,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-07T20:17:18+00:00","updated_at":"2026-01-07T21:25:36+00:00","consumed":true,"consume_pid":64779,"reason":"Closing - this was part of the overcomplicated nohup approach. See f-3ebfdf for proper design task."}
{"id":"f-2c0d58","title":"Add 'test' as valid task type","status":"closed","description":"Add 'test' to the list of valid task types so test-related tasks can be properly categorized.\n\nFiles to update:\n\n1. app/Services/TaskService.php line 13:\n   Change: private const VALID_TYPES = ['bug', 'feature', 'task', 'epic', 'chore', 'docs'];\n   To: private const VALID_TYPES = ['bug', 'feature', 'task', 'epic', 'chore', 'docs', 'test'];\n\n2. app/Commands/AddCommand.php line 21:\n   Change: {--type= : Task type (bug|feature|task|epic|chore)}\n   To: {--type= : Task type (bug|feature|task|epic|chore|test)}\n\n3. app/Commands/ListCommand.php line 19:\n   Change: {--type= : Filter by type (bug|feature|task|epic|chore)}\n   To: {--type= : Filter by type (bug|feature|task|epic|chore|test)}\n\n4. app/Commands/UpdateCommand.php line 22:\n   Change: {--type= : Update task type (bug|feature|task|epic|chore)}\n   To: {--type= : Update task type (bug|feature|task|epic|chore|test)}\n\nNo new tests needed - existing type validation tests will cover this.","type":"feature","priority":3,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T20:13:13+00:00","updated_at":"2026-01-07T21:24:28+00:00","consumed":true,"consume_pid":null,"commit_hash":"69c5c95"}
{"id":"f-2ce0e7","title":"add github markdown 'warning' block at the top of README.md about this being a giant WiP that's only been tested by one person etc","status":"closed","description":null,"type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T16:49:29+00:00","updated_at":"2026-01-07T16:49:54+00:00","consumed":true,"consumed_at":"2026-01-07T16:49:35+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n1. Added a GitHub markdown warning block at the top of README.md\n2. Marked task f-2ce0e7 as done\n3. Committed changes (commit hash: c8f44c0)\n4. Verified task state â€” no open tasks remaining\n\nThe warning block now appears at the top of README.md, indicating this is a work in progress that has only been tested by one person.\n"}
{"id":"f-2d6ed7","title":"Implement AgentHealthTracker service","status":"closed","description":"Create AgentHealthTrackerInterface and AgentHealthTracker service:\n- recordSuccess(agent): void - update success metrics\n- recordFailure(agent, FailureType): void - track failure with type (network, timeout, permission, crash)\n- isAvailable(agent): bool - check if agent is available (not in backoff)\n- getBackoffSeconds(agent): int - get remaining backoff time\n- getHealthStatus(agent): AgentHealth - get full health status\n\nUse SQLite .fuel/agent.db for persistence. Create FailureType enum and AgentHealth value object.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-5fc60a"],"created_at":"2026-01-10T11:23:37+00:00","updated_at":"2026-01-10T12:31:00+00:00","consumed":true,"consume_pid":null,"commit_hash":"6ddaef0"}
{"id":"f-2e17c1","title":"Human review needed for TUI rewrite","status":"open","description":"Task f-a316fa requires human review/decision before proceeding","type":"task","priority":2,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T09:58:14+00:00","updated_at":"2026-01-08T09:58:14+00:00"}
{"id":"f-36c3fe","title":"Configure agent permissions for cursor-agent","status":"open","description":"Agent cursor-agent was blocked from running commands while working on f-5d71ed.\n\nTo fix, either:\n1. Run `cursor-agent` interactively and select 'Always allow' for tool permissions\n2. Or add autonomous flags to .fuel/config.yaml:\n   - Claude: args: [\"--dangerously-skip-permissions\"]\n   - cursor-agent: args: [\"--force\"]\n\nSee README.md 'Agent Permissions' section for details.","type":"task","priority":1,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T10:11:29+00:00","updated_at":"2026-01-08T10:11:29+00:00"}
{"id":"f-3897c5","title":"Update ConfigService test for cursor-agent stream-json args","status":"closed","description":"Update tests/Unit/ConfigServiceTest.php to verify the new cursor-agent stream-json args in createDefaultConfig().\n\nThe test 'creates default config with comments and allowedTools' should verify that trivial/simple complexity levels have:\n- args[0] = '--force' (if uncommented in default)\n- OR verify cursor-agent has --output-format stream-json if we add it by default","type":"test","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":["f-788172"],"created_at":"2026-01-08T07:53:16+00:00","updated_at":"2026-01-08T08:06:54+00:00","consumed":true,"consume_pid":30341,"commit_hash":"a64fdef"}
{"id":"f-38a11a","title":"Update InitCommand for agent/model config setup","status":"closed","description":"Modify app/Commands/InitCommand.php: add --agent and --model flags, add interactive prompts during init (choice for agent, ask for model), call ConfigService::createDefaultConfig() to write .fuel/config.yaml. Skip prompts if flags provided or no TTY.","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-8bdbc5"],"created_at":"2026-01-07T17:24:47+00:00","updated_at":"2026-01-07T17:32:03+00:00","consumed":true,"consumed_at":"2026-01-07T17:31:07+00:00","consume_pid":null,"commit_hash":"220dc9c","consumed_exit_code":0,"consumed_output":"\nTask completed. Summary:\n\n## Task f-38a11a completed\n\n**Changes made:**\n1. Added `--agent` and `--model` flags to the `init` command signature\n2. Added interactive prompts:\n   - Agent choice (cursor-agent, claude, opencode) when no flag is provided\n   - Model input (for claude agent) when no flag is provided\n3. TTY detection: prompts are skipped when flags are provided or when not in an interactive terminal\n4. Config creation: calls `ConfigService::createDefaultConfig()` to create `.fuel/config.yaml`\n5. Config updates: updates the config file with provided agent/model values\n\n**Implementation details:**\n- Uses `$this->input->isInteractive()` and `stream_isatty(STDIN)` for TTY detection\n- Validates agent values against `VALID_AGENTS` constant\n- Updates all complexity levels with the provided agent/model when specified\n- Handles model assignment only for agents that support models (claude)\n\n**Note:** Tests require dependencies to be installed (`composer install`). The code implementation is complete and follows the requirements.\n\n**Commit:** `220dc9c` - \"feat: add agent/model flags and interactive prompts to InitCommand\"\n\nThe task has been marked as complete and the changes have been committed.\n"}
{"id":"f-39e13c","title":"Set up Rector to auto-add strict_types and enforce code quality","status":"closed","description":"Install and configure Rector to run automatically after file modifications.\n\nRules to enable:\n1. DeclareStrictTypesFixer - auto-add declare(strict_types=1) to all PHP files\n2. Modern PHP rules (8.2+)\n3. Laravel-specific rules if available\n\nIntegration:\n- Add to composer.json scripts or as a git hook\n- Should run after pint (format first, then upgrade)\n- Consider running in CI as well\n\nSee: https://getrector.com/","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T10:30:28+00:00","updated_at":"2026-01-10T11:22:33+00:00","consumed":true,"consume_pid":36020}
{"id":"f-3b1088","title":"Add parallel execution loop to ConsumeCommand","status":"closed","description":"Replace single-task blocking loop with: 1) Fill available slots across all agents, 2) Poll all running processes with isRunning(), 3) Handle completions, 4) Repeat. Use usleep(100000) between polls. File: app/Commands/ConsumeCommand.php","type":"task","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-7bd3fa","f-59663b"],"created_at":"2026-01-07T18:58:02+00:00","updated_at":"2026-01-07T19:42:42+00:00","consume_pid":null,"consumed":true,"commit_hash":"2132287"}
{"id":"f-3e8297","title":"Integrate ProcessManager into ConsumeCommand","status":"closed","description":"Replace current ad-hoc process handling in ConsumeCommand with ProcessManager.\n\nFile to modify: app/Commands/ConsumeCommand.php\n\nCurrent state:\n- ConsumeCommand spawns processes directly with Symfony Process\n- Tracks processes in local arrays\n- No centralized management\n- Output handling is inconsistent\n\nChanges needed:\n\n1. Inject ProcessManager via constructor:\n   public function __construct(\n       private TaskService $taskService,\n       private ConfigService $configService,\n       private ProcessManagerInterface $processManager,\n   )\n\n2. Replace process spawning:\n   - Remove direct Process creation\n   - Use $this->processManager->spawn($taskId, $agent, $command, $cwd)\n\n3. Replace process tracking:\n   - Remove local $runningProcesses array\n   - Use $this->processManager->getRunningCount()\n   - Use $this->processManager->getRunningProcesses()\n\n4. Replace wait logic:\n   - Use $this->processManager->waitForAny() in main loop\n   - Handle ProcessResult to update task status\n\n5. Update output display:\n   - Fetch output via $this->processManager->getOutput($taskId)\n   - Display path to log files for debugging\n\n6. Add signal handling:\n   - Call $this->processManager->registerSignalHandlers() in handle()\n   - Check isShuttingDown() in main loop\n\n7. Clean shutdown:\n   - On exit, call $this->processManager->shutdown()\n\nEnsure existing functionality is preserved - this is a refactor, not a feature change.","type":"task","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-913aa5","f-6fbcea"],"created_at":"2026-01-10T10:03:56+00:00","updated_at":"2026-01-10T10:25:17+00:00","consumed":true,"consume_pid":38077}
{"id":"f-3ebfdf","title":"Design approach for agents to survive consume being killed","status":"open","description":"Currently agents die when consume is killed. Investigate options:\n1. Use setsid/nohup with proper PTY handling (script command?)\n2. Daemonize agents properly with double-fork\n3. Write PID files and reconnect on consume restart\n4. Accept limitation and document it\n\nConsider: How to capture output? How to get exit codes? How to reconnect?","type":"task","priority":3,"labels":["needs-human"],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-07T21:20:19+00:00","updated_at":"2026-01-07T21:20:19+00:00"}
{"id":"f-40304b","title":"Add Configuration section to README.md documenting config.yaml","status":"closed","description":"README.md needs a section explaining: 1) Config file location (.fuel/config.yaml), 2) Config structure (agents section + complexity routing), 3) How to customize which agent handles each complexity level, 4) Example config YAML","type":"chore","priority":2,"labels":["docs","config"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T17:42:06+00:00","updated_at":"2026-01-07T18:01:35+00:00","commit_hash":"adb951d"}
{"id":"f-416e58","title":"Create Agent enum with resume command support","status":"closed","description":"Create app/Enums/Agent.php as a string-backed enum for supported agents.\n\n== CONTRACT (other tasks depend on this interface) ==\n\n```php\nnamespace App\\Enums;\n\nenum Agent: string {\n    case Claude = 'claude';\n    case CursorAgent = 'cursor-agent';\n    \n    // Get the command to resume a session interactively\n    public function resumeCommand(string $sessionId): string;\n    \n    // Get the command to resume with a prompt (headless)\n    public function resumeWithPromptCommand(string $sessionId, string $prompt): string;\n    \n    // Human-friendly label\n    public function label(): string;\n    \n    // Parse agent name from string (e.g., from run data)\n    public static function fromString(?string $name): ?self;\n}\n```\n\n== IMPLEMENTATION ==\n\nresumeCommand():\n- Claude: \"claude --resume {$sessionId}\"\n- cursor-agent: \"cursor-agent --resume {$sessionId}\"\n\nresumeWithPromptCommand():\n- Claude: \"claude --resume {$sessionId} -p '{$prompt}'\"\n- cursor-agent: \"cursor-agent --resume {$sessionId} -p '{$prompt}'\"\n\nfromString():\n- 'claude' => Agent::Claude\n- 'cursor-agent' => Agent::CursorAgent\n- null/unknown => null","type":"feature","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T07:56:52+00:00","updated_at":"2026-01-08T08:06:34+00:00","consumed":true,"consume_pid":25404,"commit_hash":"f213103"}
{"id":"f-4994fc","title":"Update RunService to store session_id and cost_usd","status":"closed","description":"Add session_id and cost_usd fields to run data structure in app/Services/RunService.php. Update logRun() to accept session_id, update run structure (lines 45-53), and update updateLatestRun() to allow updating session_id and cost_usd.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T07:39:11+00:00","updated_at":"2026-01-08T07:44:44+00:00","commit_hash":"9867d04"}
{"id":"f-510705","title":"Add tests for parallel consume and agent limits","status":"closed","description":"Test ConfigService agent limits (default 2, custom values). Test RunService CRUD operations. Integration test ConsumeCommand --dryrun shows parallel task selection. Files: tests/Unit/ConfigServiceTest.php, tests/Unit/RunServiceTest.php, tests/Feature/ConsumeCommandTest.php","type":"task","priority":2,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-e689d7","f-261e33","f-d443ec","f-3b1088"],"created_at":"2026-01-07T18:58:11+00:00","updated_at":"2026-01-07T19:48:16+00:00","consumed":true,"consume_pid":null,"commit_hash":"565b9bb"}
{"id":"f-56cb44","title":"Consolidate duplicate spawn logic in ProcessManager","status":"closed","description":"ProcessManager has two spawn methods with duplicated logic:\n\n1. spawn(taskId, agent, command, cwd): Process - Interface method\n2. spawnForTask(task, prompt, cwd, agentOverride): SpawnResult - ConsumeCommand version\n\nBoth methods:\n- Create output directories\n- Create stdout.log and stderr.log files  \n- Build Symfony Process\n- Set up output capture callback\n- Track in multiple arrays\n\nRefactor to:\n1. Keep spawnForTask() as the primary method (it's more complete)\n2. Have spawn() call spawnForTask() internally, or\n3. Extract shared logic into private methods:\n   - createOutputDirectory(taskId)\n   - createSymfonyProcess(commandArray, cwd, env)\n   - startWithOutputCapture(process, stdoutPath, stderrPath)\n\nAlso consolidate the tracking arrays:\n- Remove legacy $processes and $processMetadata\n- Use only $activeAgentProcesses and $agentCounts\n- Update all methods to use the new tracking\n\nFiles: app/Services/ProcessManager.php","type":"chore","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-10T10:30:14+00:00","updated_at":"2026-01-10T11:19:21+00:00","consumed":true,"consume_pid":20807}
{"id":"f-593d9b","title":"Create PromoteCommand to move backlog to tasks","status":"closed","description":"New command: app/Commands/PromoteCommand.php. Signature: fuel promote <id> [--priority=N] [--type=T] [--complexity=C] etc. Takes b-xxx backlog ID. Use both services: call $backlogService->delete($id) to remove from backlog, then $taskService->create(['title' => $item['title'], 'description' => $item['description'], ...options]). Error if ID not found or not a backlog item (b- prefix).","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-f5a98b"],"created_at":"2026-01-08T17:03:05+00:00","updated_at":"2026-01-08T17:11:52+00:00","consumed":true,"consume_pid":29650,"commit_hash":"964e070"}
{"id":"f-59663b","title":"Grant file editing and command permissions","status":"closed","description":"Need approval for:\n- Edit app/Commands/ConsumeCommand.php\n- Run ./fuel start, ./fuel done, ./fuel dep:add\n- Run ./vendor/bin/pest (tests)\n- Run ./vendor/bin/pint (formatter)\n- Run git add/commit commands\n\nTask f-3b1088 cannot proceed without these permissions.","type":"task","priority":2,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:32:02+00:00","updated_at":"2026-01-07T19:32:30+00:00"}
{"id":"f-5a27c2","title":"Configure agent permissions for cursor-agent","status":"open","description":"Agent cursor-agent was blocked from running commands while working on f-d60969.\n\nTo fix, either:\n1. Run `cursor-agent` interactively and select 'Always allow' for tool permissions\n2. Or add autonomous flags to .fuel/config.yaml:\n   - Claude: args: [\"--dangerously-skip-permissions\"]\n   - cursor-agent: args: [\"--force\"]\n\nSee README.md 'Agent Permissions' section for details.","type":"task","priority":1,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T17:15:41+00:00","updated_at":"2026-01-08T17:15:41+00:00"}
{"id":"f-5d71ed","title":"add space between task id and complexity separator so I can double click select just the id","status":"closed","description":"in boardcommand, maybe consumecommand too","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-36c3fe"],"created_at":"2026-01-08T10:10:37+00:00","updated_at":"2026-01-08T14:02:26+00:00","consume_pid":null,"commit_hash":"a9d9566"}
{"id":"f-5fc60a","title":"Create SQLite schema for agent.db","status":"closed","description":"Create .fuel/agent.db with runs and agent_health tables as specified in fuel-orchestrator-v2-roadmap.md Phase 2. Include schema for:\n- runs table: id, task_id, agent, status, exit_code, started_at, completed_at, duration_seconds, session_id, error_type\n- agent_health table: agent, last_success_at, last_failure_at, consecutive_failures, backoff_until, total_runs, total_successes\n- Indexes on task_id and agent\nAdd migration/setup logic in InitCommand.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-10T11:23:36+00:00","updated_at":"2026-01-10T12:27:09+00:00","consumed":true,"consume_pid":null,"commit_hash":"45d8d63"}
{"id":"f-65b2d3","title":"Simplify ConfigService - remove per-agent flag configuration","status":"closed","description":"All agents (cursor-agent, claude, opencode) use same flags: -p for prompt, --model for model. Remove the 'agents' section from config entirely. Hardcode -p and --model flags in ConfigService. Simplify config.yaml to map complexity -> agent + model + optional args.\n\nNew config format:\n```yaml\ncomplexity:\n  trivial:\n    agent: cursor-agent\n    model: claude-sonnet-4-20250514\n  simple:\n    agent: claude\n    model: claude-sonnet-4-20250514\n  moderate:\n    agent: claude\n    model: claude-sonnet-4-20250514\n    args: [\"--mcp-server\", \"github\"]\n  complex:\n    agent: claude\n    model: claude-opus-4-20250514\n    args: [\"--dangerously-skip-permissions\"]\n```\n\nFiles to update:\n- ConfigService.php: Remove agents section validation, simplify getAgentCommand to build [agent, -p, prompt, --model, model, ...args]\n- InitCommand.php: Simpler createDefaultConfig without agents section\n- ConfigServiceTest.php: Update tests for new simpler format\n- .fuel/config.yaml: Convert to new format","type":"chore","priority":1,"labels":["config","refactor"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T17:45:45+00:00","updated_at":"2026-01-07T18:00:01+00:00","commit_hash":"6d54794"}
{"id":"f-6d5ba1","title":"Design \"fuel others\" command to show active agent activity","status":"closed","description":"Design a new command that shows what other agents are currently working on. Use case: when an agent sees test failures, they can check if another agent is actively editing files that might cause conflicts.\n\nDecisions needed:\n1. How to track agent activity? Options:\n   - Lock files with agent ID + timestamp + files being edited\n   - Separate activity log file\n   - Extend tasks.jsonl with \"claimed_by\" and \"editing_files\" fields\n\n2. What info to show?\n   - Which tasks are in_progress and by whom\n   - Which files are being edited\n   - How recent the activity is (stale detection)\n\n3. How do agents register themselves?\n   - On `fuel start` with an agent ID?\n   - Heartbeat mechanism?\n   - Just use in_progress tasks as proxy?\n\n4. Output format for the command\n\nThis affects how agents coordinate and avoid stepping on each other.","type":"feature","priority":1,"labels":["needs-human","design"],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-07T17:59:14+00:00","updated_at":"2026-01-08T10:03:04+00:00"}
{"id":"f-6fbcea","title":"Add graceful shutdown with SIGTERM/SIGINT handling","status":"closed","description":"Add signal handling to ProcessManager for graceful shutdown when consume is interrupted.\n\nFiles to modify:\n- app/Services/ProcessManager.php\n- app/Commands/ConsumeCommand.php\n\nImplementation:\n\n1. In ProcessManager, add:\n   - registerSignalHandlers(): void - sets up pcntl signal handlers\n   - private bool $shuttingDown = false\n   - On SIGTERM/SIGINT: set $shuttingDown = true, call shutdown()\n\n2. In ConsumeCommand:\n   - Call $processManager->registerSignalHandlers() at start\n   - Check $processManager->isShuttingDown() in main loop\n   - Exit gracefully when shutting down (don't spawn new work)\n\n3. Shutdown sequence:\n   - Stop accepting new work immediately\n   - Send SIGTERM to all child processes\n   - Wait up to 30 seconds for graceful exit\n   - Send SIGKILL to any remaining\n   - Log final status of all processes\n   - Exit with appropriate code\n\n4. Handle edge cases:\n   - Double SIGTERM/SIGINT should force immediate exit\n   - Log 'Shutting down gracefully, press Ctrl+C again to force'\n\nRequires pcntl extension (standard in CLI PHP).","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-84c0cf"],"created_at":"2026-01-10T10:03:01+00:00","updated_at":"2026-01-10T10:13:38+00:00","consumed":true,"consume_pid":7558,"commit_hash":"286ee3f"}
{"id":"f-714981","title":"Grant permission to write to public/index.html","status":"closed","description":"Claude Code needs permission to write to public/index.html. Please grant write permission when the tool requests it.","type":"task","priority":2,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:17:25+00:00","updated_at":"2026-01-07T19:30:55+00:00"}
{"id":"f-749042","title":"Fix SelfUpdateCommand tests - stale assertions after implementation change","status":"closed","description":"3 tests in tests/Feature/SelfUpdateCommandTest.php are failing because they expect Guzzle 'sink' option but code uses file_get_contents.\n\nThe test at line 348 expects:\n  expect($sourceCode)->toContain(\"'sink'\");\n\nBut SelfUpdateCommand.php:190 uses:\n  $response = @file_get_contents($url, false, $context);\n\nFix: Update tests to match the actual implementation (file_get_contents), or revert to Guzzle if streaming download is important for large files.","type":"bug","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T10:30:21+00:00","updated_at":"2026-01-10T10:43:58+00:00","consumed":true,"consume_pid":null}
{"id":"f-76a083","title":"Fix runs command test - missing test-model in output","status":"closed","description":"Test 'runs command' in tests/Feature/CommandsTest.php fails with:\n'Output does not contain \"test-model\"'\n\nThe test expects RunsCommand to display the 'model' field from run entries, but it's not showing.\n\nDebug:\n1. Find the test: grep -n 'runs command' tests/Feature/CommandsTest.php\n2. Check app/Commands/RunsCommand.php exists and displays model field\n3. Check if RunsCommand is registered in app/Providers/AppServiceProvider.php\n\nLikely issue: RunsCommand may not be displaying all run fields, or the command isn't fully implemented.\n\nFiles: app/Commands/RunsCommand.php, tests/Feature/CommandsTest.php","type":"bug","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T20:12:07+00:00","updated_at":"2026-01-07T20:16:53+00:00","consume_pid":4360,"reason":"Already fixed by commit 3c900c4"}
{"id":"f-77d2bf","title":"Implement missing ProcessManager methods for ConsumeCommand compatibility","status":"closed","description":"The ConsumeCommand expects several methods that don't exist in ProcessManager:\n\nMethods to implement:\n1. hasActiveProcesses(): bool - Check if any processes are active\n2. getActiveCount(): int - Get count of active processes \n3. canSpawn(string $agentName): bool - Check if can spawn for agent\n4. spawn(array $task, string $fullPrompt, string $cwd, ?string $agentOverride): SpawnResult - Different signature than interface\n5. getActiveProcesses(): array - Get array of active process objects \n6. poll(): array<CompletionResult> - Poll processes and return completions\n7. getTrackedPids(): array<int> - Get array of tracked PIDs\n8. static isProcessAlive(int $pid): bool - Check if process PID is alive\n\nThese methods are critical for ConsumeCommand to function. The spawn() method has a different signature than ProcessManagerInterface and returns a result object with success property and process/error fields.\n\nFiles to modify:\n- app/Services/ProcessManager.php\n- app/Contracts/ProcessManagerInterface.php (may need updates)","type":"bug","priority":2,"labels":[],"size":"m","complexity":"complex","blocked_by":[],"created_at":"2026-01-10T10:13:59+00:00","updated_at":"2026-01-10T10:24:16+00:00","consumed":true,"consume_pid":22287,"commit_hash":"eb4792c"}
{"id":"f-788172","title":"Update ConfigService createDefaultConfig() with stream-json for cursor-agent","status":"closed","description":"Update app/Services/ConfigService.php createDefaultConfig() method to include --output-format stream-json in the YAML template for trivial and simple complexity levels (cursor-agent).\n\nCurrent template has commented out args for cursor-agent. Update to:\ntrivial/simple:\n  agent: cursor-agent\n  model: composer-1\n  args:\n    - \"--force\"\n    - \"--output-format\"\n    - \"stream-json\"","type":"chore","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-08T07:52:59+00:00","updated_at":"2026-01-08T08:06:19+00:00","consumed":true,"consume_pid":21395,"commit_hash":"0e7c15a"}
{"id":"f-79ee22","title":"Remove unused RuntimeException import from ConfigServiceTest","status":"closed","description":"ConfigServiceTest.php:4 has 'use RuntimeException;' which triggers a PHP warning about non-compound name having no effect. Remove the import line.","type":"chore","priority":3,"labels":["tests"],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:41:56+00:00","updated_at":"2026-01-07T17:49:04+00:00","commit_hash":"f7d0274"}
{"id":"f-7bd3fa","title":"Refactor ConsumeCommand to track per-agent concurrency","status":"closed","description":"Add $activeProcesses and $agentCounts tracking arrays. Add canSpawnAgent(agentName): bool method. Modify task selection to check agent capacity before spawning. Use ConfigService->getAgentLimit() for limits. File: app/Commands/ConsumeCommand.php","type":"task","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-e689d7","f-261e33","f-e65599"],"created_at":"2026-01-07T18:57:51+00:00","updated_at":"2026-01-07T19:36:00+00:00","consume_pid":null,"consumed":true,"commit_hash":"38c892f"}
{"id":"f-7e548d","title":"Deduplicate VALID_AGENTS constant - move to ConfigService and reference from InitCommand","status":"closed","description":"VALID_AGENTS is defined in both ConfigService.php:12 and InitCommand.php:16. Move to ConfigService as public const, have InitCommand reference it.","type":"chore","priority":2,"labels":["config","refactor"],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:41:56+00:00","updated_at":"2026-01-07T18:00:16+00:00","reason":"No longer needed - VALID_AGENTS removed in simplification (6d54794)"}
{"id":"f-833d46","title":"Add test for ConsumeCommand permission-blocked detection","status":"closed","description":"ConsumeCommand::handleProcessCompletion() now detects permission-blocked agents by checking output for patterns like 'commands are being rejected' or 'please manually complete'.\n\nWhen detected, it should:\n1. Create a needs-human task with title 'Configure agent permissions for {agentName}'\n2. Add dependency: original task blocked by the needs-human task\n3. Reopen the original task\n4. Return early (not mark as completed)\n\nTest approach - mock or simulate a process completion with permission-blocked output:\n\nFile: tests/Feature/ConsumeCommandTest.php (or new test file)\n\nTest scenarios:\n1. Output contains 'commands are being rejected' -> creates needs-human task\n2. Output contains 'please manually complete' -> creates needs-human task  \n3. Normal output without permission errors -> completes normally\n4. Verify the needs-human task has correct labels and description\n\nNote: May need to test handleProcessCompletion() indirectly through the command, or extract the detection logic to a testable method.\n\nPatterns to detect (case-insensitive):\n- 'commands are being rejected'\n- 'terminal commands are being rejected'\n- 'please manually complete'","type":"task","priority":2,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-07T20:12:49+00:00","updated_at":"2026-01-07T20:15:03+00:00","consumed":true,"consume_pid":4383}
{"id":"f-84c0cf","title":"Implement ProcessManager service","status":"closed","description":"Create app/Services/ProcessManager.php implementing ProcessManagerInterface.\n\nFile to create: app/Services/ProcessManager.php\n\nImplementation details:\n\n1. Process spawning:\n   - Use symfony/process component (already available via Laravel)\n   - Store Process objects in $this->processes keyed by taskId\n   - Generate unique process ID (p-xxxxxx format)\n   - Set up stdout/stderr capture to files in .fuel/processes/{taskId}/\n   - Start process asynchronously (non-blocking)\n\n2. Process tracking:\n   - $processes array: taskId => Process\n   - isRunning() checks process status via proc_get_status or equivalent\n   - getRunningCount() counts processes with Running status\n\n3. Process output:\n   - stdout goes to .fuel/processes/{taskId}/stdout.log\n   - stderr goes to .fuel/processes/{taskId}/stderr.log\n   - getOutput() reads from files, returns ProcessOutput\n\n4. Waiting:\n   - waitForAny() polls running processes, returns first to complete\n   - waitForAll() waits for all processes, returns array of ProcessResult\n   - Use usleep() with configurable poll interval (default 100ms)\n\n5. Killing:\n   - kill() sends SIGTERM, waits briefly, then SIGKILL if needed\n   - Updates Process status to Killed\n\n6. Shutdown:\n   - shutdown() kills all running processes gracefully\n   - Waits for completion with timeout\n\nRegister in AppServiceProvider:\n$this->app->singleton(ProcessManagerInterface::class, ProcessManager::class);","type":"task","priority":2,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-9833b8","f-ae1a32"],"created_at":"2026-01-10T10:02:52+00:00","updated_at":"2026-01-10T10:09:50+00:00","consumed":true,"consume_pid":98242}
{"id":"f-885d89","title":"Improve agent prompt in ConsumeCommand to prevent task poaching","status":"closed","description":"Update the agent prompt in app/Commands/ConsumeCommand.php to better prevent agents from picking up tasks they weren't assigned.\n\nCurrent problem: Agents sometimes run 'fuel start' on other tasks or work on things beyond their assignment, breaking parallelization.\n\nChanges needed to the $fullPrompt heredoc (around line 270):\n\n1. Replace the 'STRICT BOUNDARIES' section intro with teamwork framing:\n   'You are ONE agent in a team working in parallel on this codebase.\n   Other teammates are working on other tasks RIGHT NOW. They're counting on you to:\n   - Stay in your lane (only work on YOUR assigned task)\n   - Not step on their toes (don't touch tasks assigned to others)  \n   - Be a good teammate (log discovered work for others, don't hoard it)\n   \n   Breaking these rules wastes your teammates' work and corrupts the workflow:'\n\n2. The FORBIDDEN and ALLOWED sections are already good, keep them.\n\n3. Consider adding at the very top: 'IMPORTANT: You are being orchestrated. Trust the system.'\n\nGoal: Social/teamwork framing tends to work better than just rules for LLM agents.","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T10:21:48+00:00","updated_at":"2026-01-10T10:27:18+00:00","consumed":true,"consume_pid":71542}
{"id":"f-8a9922","title":"Add RunsCommand to view task execution history","status":"closed","description":"Create app/Commands/RunsCommand.php. Usage: fuel runs <task-id>. Shows all runs for a task from .fuel/runs/{task-id}.jsonl. Display: run_id, agent, model, started_at, duration, exit_code. Support --json flag. Support --last to show only latest run with full output. File: app/Commands/RunsCommand.php","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-d443ec"],"created_at":"2026-01-07T18:59:56+00:00","updated_at":"2026-01-07T19:43:34+00:00","consumed":true,"consume_pid":null,"reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-8bbcc0","title":"Create BacklogCommand to list backlog items","status":"closed","description":"New command: app/Commands/BacklogCommand.php. Signature: fuel backlog [--json]. Lists all items from .fuel/backlog.jsonl showing id, title, created_at. Use BacklogService (app/Services/BacklogService.php) - inject it and call $backlogService->all(). Support --json for JSON output. See plan at ~/.claude/plans/transient-drifting-moon.md","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-f5a98b"],"created_at":"2026-01-08T17:03:04+00:00","updated_at":"2026-01-08T17:11:31+00:00","consumed":true,"consume_pid":29638,"commit_hash":"608677a"}
{"id":"f-8bdbc5","title":"Add ConfigService for YAML config loading","status":"closed","description":"Create app/Services/ConfigService.php that: loads .fuel/config.yaml, validates agent names against presets (cursor-agent, claude, opencode), builds command arrays with prompt and optional model args, provides getAgentCommand(complexity, prompt) and getAgentConfig(complexity) methods. Follow TaskService patterns. Register as singleton in AppServiceProvider.","type":"task","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-07T17:24:25+00:00","updated_at":"2026-01-07T17:31:06+00:00","consume_pid":null,"consumed":true,"consumed_at":"2026-01-07T17:30:19+00:00","commit_hash":"65f0663","consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n## Summary\n\n**Task f-8bdbc5: Add ConfigService for YAML config loading** â€” Complete\n\n### Implementation\n\n1. **ConfigService.php** (`app/Services/ConfigService.php`)\n   - Loads `.fuel/config.yaml` using Symfony YAML\n   - Validates agent names against presets (cursor-agent, claude, opencode)\n   - Builds command arrays with prompt and optional model args\n   - Provides `getAgentCommand(complexity, prompt)` method\n   - Provides `getAgentConfig(complexity)` method\n   - Follows TaskService patterns (validation, error handling, structure)\n   - Includes `createDefaultConfig()` for initialization\n\n2. **Tests** (`tests/Unit/ConfigServiceTest.php`)\n   - Tests for config loading, validation, command building, and error handling\n\n3. **Service Provider** (`app/Providers/AppServiceProvider.php`)\n   - ConfigService registered as singleton (already done)\n\n### Closing Protocol Completed\n\n- Code formatted with Pint\n- Files staged and committed (commit: `65f0663`)\n- Task marked as done\n- Task state verified\n\n**Note:** Tests require `symfony/yaml` to be installed (already in `composer.json`). Run `composer install` to install dependencies and run the full test suite.\n\nThe ConfigService is ready to use. Dependent tasks (f-38a11a, f-bb62a6) can now proceed.\n"}
{"id":"f-913aa5","title":"Write tests for ProcessManager","status":"closed","description":"Create comprehensive tests for ProcessManager service.\n\nFiles to create:\n- tests/Unit/Process/ProcessTest.php\n- tests/Unit/Process/ProcessOutputTest.php\n- tests/Unit/Process/ProcessResultTest.php\n- tests/Unit/ProcessManagerTest.php\n- tests/Feature/ProcessManagerTest.php\n\nUnit tests (tests/Unit/):\n\n1. ProcessTest.php:\n   - test_process_tracks_status_correctly\n   - test_process_calculates_duration\n   - test_is_running_returns_correct_state\n\n2. ProcessOutputTest.php:\n   - test_get_combined_merges_stdout_stderr\n   - test_has_errors_detects_stderr_content\n\n3. ProcessResultTest.php:\n   - test_was_successful_checks_exit_code\n   - test_exposes_process_properties\n\n4. ProcessManagerTest.php (unit, mocked):\n   - test_spawn_creates_process_with_correct_properties\n   - test_get_running_count_returns_active_processes\n   - test_kill_terminates_process\n   - test_is_running_returns_false_after_completion\n\nFeature tests (tests/Feature/):\n\n1. ProcessManagerTest.php (integration, real processes):\n   - test_spawn_runs_real_command\n   - test_captures_stdout_to_file\n   - test_captures_stderr_to_file\n   - test_wait_for_any_returns_completed_process\n   - test_wait_for_all_waits_for_all_processes\n   - test_kill_stops_long_running_process\n   - test_shutdown_kills_all_processes\n\nUse simple commands for testing:\n- 'echo hello' for quick success\n- 'sleep 5' for long-running (to test kill)\n- 'echo error >&2' for stderr\n- 'exit 1' for failure\n\nClean up .fuel/processes/ in tearDown().","type":"task","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-84c0cf"],"created_at":"2026-01-10T10:03:12+00:00","updated_at":"2026-01-10T10:16:33+00:00","consumed":true,"consume_pid":10910}
{"id":"f-94f1aa","title":"Test docs type","status":"closed","description":null,"type":"docs","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T17:51:36+00:00","updated_at":"2026-01-07T17:51:42+00:00","reason":"Test task"}
{"id":"f-9833b8","title":"Define ProcessManagerInterface contract","status":"closed","description":"Create app/Contracts/ProcessManagerInterface.php with the contract for process management.\n\nInterface methods:\n- spawn(string $taskId, string $agent, string $command, string $cwd): Process\n- isRunning(string $taskId): bool\n- kill(string $taskId): void\n- getOutput(string $taskId): ProcessOutput\n- getRunningCount(): int\n- getRunningProcesses(): array\n- waitForAny(int $timeoutMs): ?ProcessResult\n- waitForAll(int $timeoutMs): array\n- shutdown(): void\n\nThis is the contract only - no implementation. Other tasks depend on this interface being stable.\n\nFile to create: app/Contracts/ProcessManagerInterface.php\nPattern to follow: Laravel service provider pattern, will be bound in AppServiceProvider","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T10:02:30+00:00","updated_at":"2026-01-10T10:07:24+00:00","consumed":true,"consume_pid":null}
{"id":"f-9b8151","title":"Create RunsCommand to view run history with session IDs","status":"closed","description":"Create app/Commands/RunsCommand.php with:\n- Signature: runs {task-id} {--last} {--json}\n- Shows all runs for a task with session_id, cost, duration\n- Displays 'Resume: claude --resume <session_id>' for easy continuation\n- Follow existing command patterns in codebase","type":"feature","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-4994fc"],"created_at":"2026-01-08T07:39:23+00:00","updated_at":"2026-01-08T07:47:44+00:00","commit_hash":"f5cb776"}
{"id":"f-9c1dac","title":"Make InitCommand idempotent - only create starter task if tasks.jsonl is empty","status":"closed","description":"In app/Commands/InitCommand.php, wrap the starter task creation (lines 38-44) in a check: if ($taskService->all()->isEmpty()). This prevents duplicate starter tasks when running init on an already-initialized project.","type":"task","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T16:57:04+00:00","updated_at":"2026-01-07T16:57:44+00:00","consumed":true,"consumed_at":"2026-01-07T16:57:08+00:00","consume_pid":null,"commit_hash":"44c389f","consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n## Summary\n\n1. Updated `InitCommand.php` to check if `tasks.jsonl` is empty before creating a starter task, wrapping lines 38-44 in `if ($taskService->all()->isEmpty())`.\n2. Added a test to verify idempotency: running `init` twice does not create duplicate starter tasks.\n3. All tests pass (including the new idempotency test).\n4. Code formatted with Pint.\n5. Committed changes: `44c389f`.\n6. Marked task `f-9c1dac` as done with the commit hash.\n\nThe `init` command is now idempotent: it only creates a starter task when `tasks.jsonl` is empty, preventing duplicates when run multiple times on an already-initialized project.\n"}
{"id":"f-9dfdac","title":"Integrate RunService into ConsumeCommand","status":"closed","description":"Replace consumed_* fields in task with RunService logging. On agent start: create run entry with started_at. On completion: update with ended_at, exit_code, output. Keep consumed flag in task for quick filtering. File: app/Commands/ConsumeCommand.php","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-d443ec","f-7bd3fa"],"created_at":"2026-01-07T18:58:02+00:00","updated_at":"2026-01-07T19:31:02+00:00","consumed":true,"consumed_at":"2026-01-07T19:30:19+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\n## Summary\n\nIntegrated RunService into ConsumeCommand.\n\n### Changes Made:\n\n1. **RunService.php** â€” Added `updateLatestRun()`:\n   - Updates the most recent run entry with completion data\n   - Handles output truncation (10KB)\n   - Throws exception if no runs exist\n\n2. **ConsumeCommand.php** â€” Integrated RunService:\n   - Injected RunService into the `handle()` method\n   - On agent start: Creates a run entry with `started_at` and `agent`\n   - On completion: Updates the run entry with `ended_at`, `exit_code`, and `output`\n   - Removed `consumed_at`, `consumed_exit_code`, `consumed_output` from task updates\n   - Kept `consumed` flag for quick filtering\n   - Retry logic: Creates a new run entry for each retry attempt\n\n3. **RunServiceTest.php** â€” Added tests:\n   - Test for updating latest run with completion data\n   - Test for exception when no runs exist\n   - Test for updating only the latest run when multiple exist\n   - Test for output truncation when updating\n\n### Files Modified:\n- `app/Services/RunService.php` â€” Added `updateLatestRun()` method\n- `app/Commands/ConsumeCommand.php` â€” Integrated RunService logging\n- `tests/Unit/RunServiceTest.php` â€” Added tests for `updateLatestRun()`\n\n### Next Steps (Closing Protocol):\n\nSince terminal commands are being rejected, please manually complete:\n\n1. Run tests: `./vendor/bin/pest tests/Unit/RunServiceTest.php`\n2. Run formatter: `./vendor/bin/pint app/Services/RunService.php app/Commands/ConsumeCommand.php tests/Unit/RunServiceTest.php`\n3. Stage changes: `git add app/Services/RunService.php app/Commands/ConsumeCommand.php tests/Unit/RunServiceTest.php`\n4. Commit: `git commit -m \"feat: integrate RunService into ConsumeCommand\"`\n5. Mark task done: `./fuel done f-9dfdac --commit=<hash>`\n6. Verify: `./fuel ready`\n\nThe implementation is complete and ready for testing. All `consumed_*` fields (except `consumed` flag) have been replaced with RunService logging as specified.\n","reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-a0f3ba","title":"Configure agent permissions for cursor-agent","status":"open","description":"Agent cursor-agent was blocked from running commands while working on f-c32919.\n\nTo fix, either:\n1. Run `cursor-agent` interactively and select 'Always allow' for tool permissions\n2. Or add autonomous flags to .fuel/config.yaml:\n   - Claude: args: [\"--dangerously-skip-permissions\"]\n   - cursor-agent: args: [\"--force\"]\n\nSee README.md 'Agent Permissions' section for details.","type":"task","priority":1,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T17:24:33+00:00","updated_at":"2026-01-08T17:24:33+00:00"}
{"id":"f-a228f7","title":"Add symfony/yaml dependency","status":"closed","description":"Run: composer require symfony/yaml. Required for ConfigService YAML parsing.","type":"task","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:24:47+00:00","updated_at":"2026-01-07T17:27:08+00:00","consumed":true,"consumed_at":"2026-01-07T17:26:53+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n**Completed:**\n1. Added `symfony/yaml` dependency to `composer.json` (version `^7.0`)\n2. Marked task f-a228f7 as done\n3. Committed changes: `feat: add symfony/yaml dependency` (commit 7428abb)\n4. Verified task state â€” task is closed\n\n**Note:** Run `composer install` or `composer update` to install the package. The dependency is now in `composer.json` and ready for ConfigService YAML parsing.\n\nThe task is complete and all closing protocol steps have been followed.\n"}
{"id":"f-a316fa","title":"Rewrite ConsumeCommand as proper TUI","status":"open","description":"Current issues:\n- Duplicate lines when agents start\n- Lines that don't go away properly\n- Static icons (should animate to show progress)\n\nDesired features:\n- Animated spinners for in-progress agents\n- Keyboard navigation to select/inspect tasks\n- View agent output for selected task\n- Stop/kill agents from TUI\n- Scrollable panels\n\nConsider Laravel Prompts or curses-style library.","type":"feature","priority":2,"labels":["tui","consume","human","needs-human"],"size":"m","complexity":"complex","blocked_by":["f-2e17c1"],"created_at":"2026-01-08T09:55:54+00:00","updated_at":"2026-01-08T10:02:07+00:00"}
{"id":"f-a4a122","title":"Remove HTML comment from public/index.html","status":"closed","description":"Remove the <!-- Fuel test comment --> from public/index.html","type":"task","priority":2,"labels":[],"size":"m","complexity":"complex","blocked_by":["f-d1d2e5","f-714981"],"created_at":"2026-01-07T18:03:51+00:00","updated_at":"2026-01-07T19:21:18+00:00","consume_pid":null,"consumed":true,"consumed_at":"2026-01-07T19:16:18+00:00","consumed_exit_code":0,"consumed_output":"According to the needs-human workflow, I must now exit immediately since I'm blocked on needing permission to edit the file. The human will need to:\n\n1. Grant Claude Code permission to write to `public/index.html` when prompted\n2. Mark the needs-human task f-714981 as done using `./fuel done f-714981`  \n3. The original task f-a4a122 will then reappear in `./fuel ready` for completion\n\nI cannot proceed with the task without write permission, so I'm exiting now.\n"}
{"id":"f-a5a060","title":"don't override the base command, when I run 'fuel' it should show the list of available commands","status":"closed","description":"right now if you run ./fuel directly it shows you the ready tasks, but we have fuel ready for that. Users expect to see usage information and the list of available commands","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-d207ea"],"created_at":"2026-01-08T13:56:18+00:00","updated_at":"2026-01-08T13:59:50+00:00","consume_pid":null,"commit_hash":"fcc1c3bda8be8f859374d37b284558a9cba05d69"}
{"id":"f-adea6f","title":"Review and cleanup parallel consume implementation","status":"closed","description":"Review all parallel consume tasks (f-7bd3fa chain). Fix issues: 1) Commit missing RunService files (app/Services/RunService.php, tests/Unit/RunServiceTest.php), 2) Register RunService in AppServiceProvider as singleton, 3) Fix RuntimeException import warning in tests/Unit/RunServiceTest.php line 4, 4) Verify all tasks followed session close protocol (tests, lint, commit). Files: app/Providers/AppServiceProvider.php, app/Services/RunService.php, tests/Unit/RunServiceTest.php","type":"chore","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-510705"],"created_at":"2026-01-07T19:40:07+00:00","updated_at":"2026-01-07T19:50:16+00:00","consume_pid":null,"consumed":true,"reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-ae1a32","title":"Define Process value objects (Process, ProcessOutput, ProcessResult)","status":"closed","description":"Create value objects for process management in app/Process/ directory.\n\nFiles to create:\n\n1. app/Process/Process.php - Represents a running or completed process\n   Properties:\n   - string $id (unique process ID, not task ID)\n   - string $taskId (fuel task ID this process is working on)\n   - string $agent (agent name from config)\n   - string $command (full command being run)\n   - string $cwd (working directory)\n   - int $pid (OS process ID)\n   - ProcessStatus $status (enum: pending, running, completed, failed, killed)\n   - ?int $exitCode\n   - ?DateTimeImmutable $startedAt\n   - ?DateTimeImmutable $completedAt\n   Methods:\n   - isRunning(): bool\n   - getDurationSeconds(): ?int\n\n2. app/Process/ProcessOutput.php - Captured stdout/stderr\n   Properties:\n   - string $stdout\n   - string $stderr\n   - string $stdoutPath (file path where stdout is saved)\n   - string $stderrPath (file path where stderr is saved)\n   Methods:\n   - getCombined(): string\n   - hasErrors(): bool\n\n3. app/Process/ProcessResult.php - Result when process completes\n   Properties:\n   - Process $process\n   - ProcessOutput $output\n   - bool $success (exitCode === 0)\n   Methods:\n   - getTaskId(): string\n   - getExitCode(): int\n   - wasSuccessful(): bool\n   - getDurationSeconds(): int\n\n4. app/Process/ProcessStatus.php - Enum for process states\n   Cases: Pending, Running, Completed, Failed, Killed\n\nPattern: Use readonly classes where appropriate. These are immutable value objects.","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T10:02:41+00:00","updated_at":"2026-01-10T10:06:35+00:00","consumed":true,"consume_pid":92201,"commit_hash":"4282bdd"}
{"id":"f-b3bb3e","title":"show complexity in fuel board","status":"closed","description":null,"type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:53:15+00:00","updated_at":"2026-01-07T19:56:44+00:00","consume_pid":null,"consumed":true,"reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-b61ddd","title":"Fix potential command injection in ResumeSessionCommand","status":"closed","description":"In app/Commands/ResumeSessionCommand.php line 123, the exec($command) call uses a string built from user-provided prompt.\n\nThe Agent::resumeWithPromptCommand() wraps the prompt in single quotes, but this doesn't handle prompts containing single quotes properly.\n\nFix options:\n1. Use escapeshellarg() on the prompt in resumeWithPromptCommand()\n2. Use proc_open() or Symfony Process with array arguments instead of exec()\n3. Escape single quotes in the prompt (replace ' with '\\'')","type":"bug","priority":1,"labels":["security"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T08:15:27+00:00","updated_at":"2026-01-08T08:16:16+00:00","consumed":true,"consume_pid":null,"commit_hash":"581b07a"}
{"id":"f-b79ede","title":"Merge fuel-php-bin PRs and tag v0.1.0 release after workflow completes","status":"closed","description":"Workflow: https://github.com/ashleyhindle/fuel-php-bin/actions/runs/20812164694\n\nAfter workflow completes:\n1. Merge the 4 PRs in ashleyhindle/fuel-php-bin\n2. cd /tmp/fuel-php-bin && git pull && git tag v0.1.0 && git push --tags\n3. Test: cd /Users/ashleyhindle/Code/fuel && ./build.sh && ./builds/fuel-darwin-arm64 consume --dryrun","type":"task","priority":2,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T09:35:17+00:00","updated_at":"2026-01-08T09:48:55+00:00","commit_hash":"2a1968b"}
{"id":"f-bb62a6","title":"Update ConsumeCommand to use ConfigService","status":"closed","description":"Modify app/Commands/ConsumeCommand.php: inject ConfigService, use getAgentCommand(task complexity, prompt) to build agent command array with model support. Keep --agent flag as override (bypasses config routing). Remove hardcoded cursor-agent default.","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-8bdbc5"],"created_at":"2026-01-07T17:24:47+00:00","updated_at":"2026-01-07T17:32:56+00:00","consumed":true,"consumed_at":"2026-01-07T17:32:04+00:00","consume_pid":null,"commit_hash":"c06dd2a","consumed_exit_code":0,"consumed_output":"\n## Summary\n\nUpdated `ConsumeCommand` to use `ConfigService` for agent routing.\n\n### Changes Made:\n\n1. **Injected ConfigService**: Added `ConfigService` as a dependency in the `handle()` method\n2. **Removed hardcoded default**: Changed `--agent=cursor-agent` to `--agent=` (optional override)\n3. **Implemented config-based routing**: When `--agent` is not provided, the command now:\n   - Extracts task complexity (defaults to 'simple')\n   - Calls `configService->getAgentCommand($complexity, $prompt)` to get the command array with model support\n   - Handles errors gracefully with helpful messages\n4. **Preserved override behavior**: The `--agent` flag still bypasses config routing when provided\n5. **Configured cwd support**: ConfigService is configured with the cwd path when `--cwd` option is used\n\n### Implementation Details:\n\n- The command array is built dynamically based on task complexity\n- Model flags are automatically included when specified in the config\n- Error handling provides clear guidance if config is missing\n- The `--agent` override still works for manual agent selection\n\n### Status:\n\n- Code formatted and linted\n- Changes committed (commit: c06dd2a)\n- Task marked as complete\n\nThe ConsumeCommand now routes tasks to appropriate agents based on complexity as configured in `.fuel/config.yaml`, while maintaining backward compatibility with the `--agent` override flag.\n"}
{"id":"f-bc6208","title":"Add 'fuel resume' command to continue a task session","status":"closed","description":"Create app/Commands/ResumeSessionCommand.php:\n\n```bash\nfuel resume <task-id>    # Resume the latest run's session interactively\nfuel resume <task-id> --run=<run-id>  # Resume a specific run\nfuel resume <task-id> -p 'Continue working'  # Resume with a prompt (headless)\n```\n\nImplementation:\n1. Find the task and get its latest run (or specified run)\n2. Get session_id from run data\n3. Use Agent enum to build the resume command\n4. Exec the agent command (replace current process) or spawn it\n\nThis allows users to easily continue where an agent left off without manually copying session IDs.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-416e58"],"created_at":"2026-01-08T07:59:13+00:00","updated_at":"2026-01-08T08:08:52+00:00","consumed":true,"consume_pid":null,"commit_hash":"666586c"}
{"id":"f-c1325b","title":"Add test for ConfigService createDefaultConfig YAML output","status":"closed","description":"ConfigService::createDefaultConfig() now generates a YAML template string with comments showing autonomous mode flags. Need to verify the output is valid YAML and contains expected content.\n\nTest should verify:\n1. Generated config is valid YAML (can be parsed)\n2. Contains complexity levels: trivial, simple, moderate, complex\n3. Contains agents section with cursor-agent and claude\n4. moderate/complex have --allowedTools args\n5. Comments exist showing --force and --dangerously-skip-permissions options\n\nFile: tests/Unit/ConfigServiceTest.php\n\nAdd test like:\n```php\nit('creates default config with comments and allowedTools', function () {\n    $configPath = $this->tempDir.'/.fuel/config.yaml';\n    $service = new ConfigService($configPath);\n    $service->createDefaultConfig();\n    \n    $content = file_get_contents($configPath);\n    expect($content)->toContain('--allowedTools');\n    expect($content)->toContain('# args:');\n    expect($content)->toContain('--dangerously-skip-permissions');\n    expect($content)->toContain('--force');\n    \n    // Verify it's valid YAML\n    $parsed = Yaml::parseFile($configPath);\n    expect($parsed['complexity']['moderate']['agent'])->toBe('claude');\n});\n```","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T20:12:35+00:00","updated_at":"2026-01-07T21:07:09+00:00","consume_pid":57212,"consumed":true}
{"id":"f-c33346","title":"Add .fuel/runs/ to .gitignore","status":"closed","description":"Update InitCommand to add .fuel/runs/ to .gitignore when initializing. Run logs are local debugging data, not meant for version control. Also update the template .gitignore in InitCommand. File: app/Commands/InitCommand.php","type":"task","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T18:57:39+00:00","updated_at":"2026-01-07T19:21:18+00:00","consumed":true,"consumed_at":"2026-01-07T19:15:44+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\n## Summary\n\nTask f-c33346 completed: Added `.fuel/runs/` to `.gitignore` handling in `InitCommand`.\n\n**Changes made:**\n1. Added `ensureGitignoreEntry()` that:\n   - Checks if `.gitignore` exists\n   - Adds `.fuel/runs/` if missing\n   - Creates `.gitignore` with `.fuel/runs/` if it doesn't exist\n   - Skips if already present\n2. Called this method from `handle()` during initialization (line 55)\n\n**File modified:**\n- `app/Commands/InitCommand.php` - Added gitignore handling method and integration\n\nThe implementation follows existing patterns in the file and handles edge cases. No linting errors detected.\n\n**Note:** Terminal commands were rejected, so please complete the closing protocol manually:\n1. Run tests: `./vendor/bin/pest`\n2. Format code: `./vendor/bin/pint app/Commands/InitCommand.php`\n3. Stage and commit: `git add app/Commands/InitCommand.php && git commit -m \"feat: add .fuel/runs/ to .gitignore in InitCommand\"`\n4. Mark task complete: `./fuel done f-c33346`\n5. Verify: `./fuel ready`\n\nThe code is ready and should work as expected.\n"}
{"id":"f-c56133","title":"Add 'fuel summary' command to view task outcome","status":"closed","description":"Create app/Commands/SummaryCommand.php to show a human-friendly summary of a task's execution:\n\n```bash\nfuel summary <task-id>           # Show latest run summary\nfuel summary <task-id> --all     # Show all runs\n```\n\nOutput format:\n```\nTask: f-abc123 - Implement user authentication\nStatus: closed (completed)\nRuns: 2\n\nLatest Run (run-xyz789)\n  Agent: claude (sonnet)\n  Duration: 5m 30s\n  Cost: $0.08\n  Exit: 0 (success)\n  \n  Session: 550e8400-e29b-41d4-a716-446655440000\n  Resume: claude --resume 550e8400-e29b-41d4-a716-446655440000\n\nOutput Summary:\n  - Created app/Services/AuthService.php\n  - Updated 3 files\n  - Added 5 tests (all passing)\n```\n\nThe 'Output Summary' section could parse common patterns from the output:\n- File operations (created, modified, deleted)\n- Test results\n- Errors/warnings\n- Git commits made\n\nThis gives users a quick overview without wading through raw agent output.","type":"feature","priority":2,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-416e58"],"created_at":"2026-01-08T07:59:30+00:00","updated_at":"2026-01-08T08:11:29+00:00","consumed":true,"consume_pid":null,"commit_hash":"c9bbba4"}
{"id":"f-c6352b","title":"Update ConsumeCommand for incremental session_id parsing","status":"closed","description":"Modify app/Commands/ConsumeCommand.php to:\n1. Extend processMetadata to track session_id and output_buffer\n2. In pollRunningProcesses(): read incremental output via getIncrementalOutput(), parse first JSON line for init message with session_id, store via RunService::updateLatestRun()\n3. In handleProcessCompletion(): parse output for result JSON line, extract session_id and total_cost_usd\n4. In refreshDisplay(): show shortened session ID for active Claude processes","type":"feature","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-4994fc"],"created_at":"2026-01-08T07:39:23+00:00","updated_at":"2026-01-08T07:46:40+00:00","commit_hash":"c443530"}
{"id":"f-c6cb42","title":"Add retry logic with exponential backoff","status":"closed","description":"Integrate retry logic into ProcessManager/ConsumeCommand:\n- Configurable max_attempts per agent in config.yaml\n- Exponential backoff: 30s, 60s, 120s, 240s, 480s\n- Track failure type to determine if retryable\n- Network/timeout errors: retryable\n- Permission errors: not retryable (needs human)\n- Crash errors: retryable with limit\n\nUpdate spawnForTask to check health before spawning.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"moderate","blocked_by":["f-2d6ed7"],"created_at":"2026-01-10T11:23:37+00:00","updated_at":"2026-01-10T12:37:55+00:00","consumed":true,"consume_pid":null,"commit_hash":"5d9d48e"}
{"id":"f-c71bd6","title":"Update ConsumeCommand display for multiple active tasks","status":"closed","description":"Modify refreshDisplay() to show all active tasks. Each shows: agent name, task ID, elapsed time. Terminal title shows count: Fuel: 3 agents running. Keep max 5 status lines. File: app/Commands/ConsumeCommand.php","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-3b1088"],"created_at":"2026-01-07T18:58:11+00:00","updated_at":"2026-01-07T19:42:12+00:00","reason":"Completed as part of f-3b1088. Display now shows all active tasks with ID and duration. Terminal title shows count."}
{"id":"f-ca969d","title":"Add complexity to fuel tree command","status":"closed","description":"near the priority, but small, maybe an emoji? or single char?","type":"task","priority":3,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:34:49+00:00","updated_at":"2026-01-07T19:51:41+00:00","consumed":true,"consume_pid":null,"reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-cb77bd","title":"Add --someday flag to AddCommand","status":"closed","description":"Modify app/Commands/AddCommand.php. Add --someday boolean option. When set, use BacklogService (app/Services/BacklogService.php) - inject it and call $backlogService->add($title, $description) instead of taskService->create(). Ignore other options (--priority, --type, --complexity etc) when --someday is set.","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-f5a98b"],"created_at":"2026-01-08T17:03:05+00:00","updated_at":"2026-01-08T17:13:27+00:00","consumed":true,"consume_pid":50749,"commit_hash":"e663cac"}
{"id":"f-cdaccd","title":"Add ConfigService tests","status":"closed","description":"Create tests/Unit/ConfigServiceTest.php: test config loading, complexity routing, default fallback, invalid agent error, getAgentCommand output format. Follow existing TaskServiceTest patterns.","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-8bdbc5"],"created_at":"2026-01-07T17:24:47+00:00","updated_at":"2026-01-07T17:37:02+00:00","consume_pid":null,"consumed":true,"consumed_at":"2026-01-07T17:36:23+00:00","commit_hash":"388305e","consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n## Summary\n\n**Task f-cdaccd: Add ConfigService tests** â€” Complete\n\n### What was done\n\n1. Reviewed and fixed `tests/Unit/ConfigServiceTest.php`:\n   - Added missing `RuntimeException` import\n   - Updated `beforeEach` to create the `.fuel` directory\n   - Tests already covered all requirements\n\n2. Test coverage verified:\n   - Config loading (file existence, YAML parsing, caching)\n   - Complexity routing (all four complexity levels)\n   - Default fallback (prompt_flag, model_flag defaults)\n   - Invalid agent error handling (validation tests)\n   - getAgentCommand output format (array structure for all complexities)\n\n3. Followed TaskServiceTest patterns:\n   - Similar `beforeEach`/`afterEach` structure\n   - Same test organization and naming\n   - Consistent use of Pest expectations\n\n### Closing protocol completed\n\n- Code formatted with Pint (passed)\n- Files staged and committed (commit: `388305e`)\n- Task marked as done\n- Task state verified\n\n**Note:** Tests require `symfony/yaml` to be installed. Run `composer install` to install dependencies before running the test suite. The tests are complete and follow the required patterns.\n"}
{"id":"f-d1d2e5","title":"Add HTML comment to public/index.html","status":"closed","description":"Add <!-- Fuel test comment --> near the top of public/index.html","type":"task","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T18:03:47+00:00","updated_at":"2026-01-07T18:04:51+00:00","consumed":true,"consumed_at":"2026-01-07T18:04:40+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\nTask completed.\n\n1. Added the HTML comment `<!-- Fuel test comment -->` near the top of `public/index.html` (right after the DOCTYPE declaration)\n2. Marked the task as done: `./fuel done f-d1d2e5`\n3. Committed the change: `git commit -m \"feat: add HTML comment to public/index.html\"` (commit hash: 9c9a1f3)\n4. Verified task state: `./fuel ready` shows the task is no longer in the open tasks list\n\nThe comment has been added and the change is committed.\n"}
{"id":"f-d207ea","title":"Configure agent permissions for cursor-agent","status":"open","description":"Agent cursor-agent was blocked from running commands while working on f-a5a060.\n\nTo fix, either:\n1. Run `cursor-agent` interactively and select 'Always allow' for tool permissions\n2. Or add autonomous flags to .fuel/config.yaml:\n   - Claude: args: [\"--dangerously-skip-permissions\"]\n   - cursor-agent: args: [\"--force\"]\n\nSee README.md 'Agent Permissions' section for details.","type":"task","priority":1,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T13:57:17+00:00","updated_at":"2026-01-08T13:57:17+00:00"}
{"id":"f-d443ec","title":"Create RunService for per-task execution logs","status":"closed","description":"Create app/Services/RunService.php. Storage: .fuel/runs/{task-id}.jsonl. Methods: logRun(taskId, data): void, getRuns(taskId): array, getLatestRun(taskId): ?array. Run schema: {run_id, agent, model, started_at, ended_at, exit_code, output}. Generate run_id as run- + 6 hex chars. Truncate output to 10KB. Create runs/ dir on first write.","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T18:57:39+00:00","updated_at":"2026-01-07T19:21:18+00:00","consumed":true,"consumed_at":"2026-01-07T19:15:05+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":"\n## Summary\n\nCreated `RunService` for per-task execution logs.\n\n### Created Files:\n1. **`app/Services/RunService.php`** â€” Service implementation with:\n   - `logRun(taskId, data): void` â€” Logs a run for a task\n   - `getRuns(taskId): array` â€” Returns all runs for a task\n   - `getLatestRun(taskId): ?array` â€” Returns the most recent run\n   - Storage: `.fuel/runs/{task-id}.jsonl` (one file per task)\n   - Run ID generation: `run-` + 6 hex characters\n   - Output truncation: 10KB max\n   - Directory creation: Creates `.fuel/runs/` on first write\n   - File locking: Exclusive/shared locks with retry logic (same pattern as TaskService)\n   - Atomic writes: Temp file + rename pattern\n\n2. **`tests/Unit/RunServiceTest.php`** â€” Test suite covering:\n   - Directory creation\n   - Run ID generation\n   - Schema fields\n   - Output truncation\n   - Multiple runs per task\n   - Latest run retrieval\n   - Separate storage per task\n\n### Implementation Details:\n- Follows TaskService patterns (locking, atomic writes, error handling)\n- Run schema: `{run_id, agent, model, started_at, ended_at, exit_code, output}`\n- All fields optional except `run_id` (auto-generated) and `started_at` (defaults to now)\n- Output truncated to exactly 10KB if longer\n- No linter errors detected\n\n### Next Steps (Closing Protocol):\nSince terminal commands are being rejected, please manually complete:\n1. Run tests: `./vendor/bin/pest tests/Unit/RunServiceTest.php`\n2. Run formatter: `./vendor/bin/pint app/Services/RunService.php tests/Unit/RunServiceTest.php`\n3. Stage changes: `git add app/Services/RunService.php tests/Unit/RunServiceTest.php`\n4. Commit: `git commit -m \"feat: add RunService for per-task execution logs\"`\n5. Mark task done: `./fuel done f-d443ec --commit=<hash>`\n6. Verify: `./fuel ready`\n\nThe implementation is complete and ready for testing.\n"}
{"id":"f-d4a29b","title":"Test backlog item","status":"closed","description":"This is a test description","type":"feature","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T17:11:14+00:00","updated_at":"2026-01-08T17:12:40+00:00","consumed":true,"consume_pid":37980,"commit_hash":"9a47f36"}
{"id":"f-d651ce","title":"add 'fuel upgrade' alias for 'self update'","status":"closed","description":"I find myself typing fuel upgrade, makes sense it should work","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T10:13:53+00:00","updated_at":"2026-01-08T13:57:11+00:00","consumed":true,"consume_pid":null,"commit_hash":"eb9af8e"}
{"id":"f-da2016","title":"Fix ConfigServiceTest to expect max_attempts in agent definition","status":"closed","description":"tests/Unit/ConfigServiceTest.php:183 - The test expects agent definition without max_attempts field, but the actual implementation now includes max_attempts: 3. Update the expected array to include 'max_attempts' => 3.","type":"bug","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-10T12:34:59+00:00","updated_at":"2026-01-10T12:35:58+00:00","consumed":true,"consume_pid":null,"commit_hash":"b876891"}
{"id":"f-dbd39e","title":"Update README.md with backlog feature documentation","status":"closed","description":"Add section to README.md documenting: fuel add --someday, fuel backlog, fuel promote, fuel defer, fuel remove. Explain the simplified backlog format (title/description only) vs full tasks. Include examples.","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":["f-8bbcc0","f-cb77bd","f-894eb0","f-593d9b","f-1c15a3"],"created_at":"2026-01-08T17:03:58+00:00","updated_at":"2026-01-08T17:16:21+00:00","consumed":true,"consume_pid":null}
{"id":"f-de53dc","title":"fuel resume with cursor-agent needs to change the command","status":"closed","description":"to this format cursor-agent --resume=c16508f6-bd60-4175-8807-b552aa2f5c0a","type":"task","priority":2,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-08T17:17:41+00:00","updated_at":"2026-01-08T17:18:33+00:00","consumed":true,"consume_pid":null,"commit_hash":"1183761"}
{"id":"f-e08f5b","title":"Update RunsCommand to show agent-specific resume command","status":"closed","description":"Update app/Commands/RunsCommand.php displayRunDetails() to show the correct resume command based on the agent used:\n\n- Claude: claude --resume <session_id>\n- cursor-agent: cursor-agent --resume <session_id>\n\nCheck the run's 'agent' field to determine which resume command to show.","type":"feature","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":["f-e149aa"],"created_at":"2026-01-08T07:53:06+00:00","updated_at":"2026-01-08T07:59:52+00:00","reason":"Duplicate of f-e132cb which properly depends on Agent enum"}
{"id":"f-e132cb","title":"Update RunsCommand to use Agent enum for resume command","status":"closed","description":"Update app/Commands/RunsCommand.php to use the Agent enum:\n\n1. In displayRunDetails(), use Agent::fromString($run['agent']) to get the enum\n2. Call $agent->resumeCommand($run['session_id']) to get the correct command\n3. If agent is unknown/null, fall back to showing just the session ID without a resume command\n\nThis replaces the hardcoded 'claude --resume' with agent-aware commands.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":["f-416e58"],"created_at":"2026-01-08T07:59:04+00:00","updated_at":"2026-01-08T08:07:17+00:00","consumed":true,"consume_pid":null,"commit_hash":"c5caedf"}
{"id":"f-e149aa","title":"Update .fuel/config.yaml with --output-format stream-json for cursor-agent","status":"closed","description":"Add streaming JSON output to trivial and simple complexity levels for cursor-agent. This enables session ID capture.\n\nChanges to .fuel/config.yaml:\n- trivial: add args: [\"--output-format\", \"stream-json\"] alongside --force\n- simple: add args: [\"--output-format\", \"stream-json\"] alongside --force\n\nThe existing ConsumeCommand parsing already handles this format since cursor-agent uses the same stream-json structure as Claude.","type":"chore","priority":1,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-08T07:52:11+00:00","updated_at":"2026-01-08T08:05:40+00:00","consumed":true,"consume_pid":21387}
{"id":"f-e65599","title":"Grant file edit and fuel command permissions","status":"closed","description":"Claude needs approval to: 1) Edit app/Commands/ConsumeCommand.php to implement per-agent concurrency tracking, 2) Run ./fuel start f-7bd3fa to claim the task, 3) Run tests and linter after implementation, 4) Run git commands to commit changes. Please approve these permissions in Claude Code settings.","type":"task","priority":2,"labels":["needs-human"],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:30:02+00:00","updated_at":"2026-01-07T19:32:30+00:00"}
{"id":"f-e689d7","title":"Add agents config section to ConfigService","status":"closed","description":"Add 'agents' key validation in validateConfig(). Structure: agents: { agent-name: { max_concurrent: N } }. Validate max_concurrent is positive int. Update createDefaultConfig() to include agents section with cursor-agent: 2, claude: 2 defaults. Files: app/Services/ConfigService.php, .fuel/config.yaml","type":"task","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T18:57:38+00:00","updated_at":"2026-01-07T19:08:39+00:00","commit_hash":"62e3e70"}
{"id":"f-eab11d","title":"Extract calculateDuration to shared trait","status":"closed","description":"The calculateDuration() method is duplicated in RunsCommand.php and SummaryCommand.php.\n\nCreate app/Commands/Concerns/CalculatesDuration.php trait with:\n- calculateDuration(?string $startedAt, ?string $endedAt): string\n\nUpdate RunsCommand and SummaryCommand to use the trait.","type":"chore","priority":3,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-08T08:15:20+00:00","updated_at":"2026-01-08T08:16:11+00:00","consumed":true,"consume_pid":null}
{"id":"f-ecb93b","title":"Update default model names in ConfigService to current Claude models","status":"closed","description":"ConfigService.php:264-268 uses 'claude-3-sonnet' and 'claude-3-opus' which are outdated. Update to current model IDs like 'sonnet' or 'opus'. Also update InitCommand.php:130 model prompt examples.","type":"chore","priority":2,"labels":["config"],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:41:56+00:00","updated_at":"2026-01-07T17:53:28+00:00","commit_hash":"1b2039d"}
{"id":"f-efa354","title":"show complexity or agent name in consume command","status":"closed","description":"how do we make more space so we can fit more on a small laptop screen? but show more information?","type":"task","priority":3,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-07T19:38:18+00:00","updated_at":"2026-01-07T19:51:45+00:00","consumed":true,"consume_pid":null,"reason":"Auto-completed by consume (agent exit 0)"}
{"id":"f-f3a6c7","title":"Test session_id capture - just echo 'hello world' and mark this task done","status":"closed","description":null,"type":"task","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-08T08:25:48+00:00","updated_at":"2026-01-08T08:26:17+00:00","consumed":true,"consume_pid":null}
{"id":"f-f5a98b","title":"Add backlog support to TaskService","status":"closed","description":"Add methods: getBacklogPath(), allBacklog(), addToBacklog(title, description), findBacklogById(id), deleteBacklogItem(id), delete(id) for tasks, remove(id) unified, defer(id), promote(id, taskOptions). Backlog stored in .fuel/backlog.jsonl with format {id: b-xxxxxx, title, description, created_at}. See plan at ~/.claude/plans/transient-drifting-moon.md","type":"task","priority":2,"labels":[],"size":"m","complexity":"moderate","blocked_by":[],"created_at":"2026-01-08T17:02:51+00:00","updated_at":"2026-01-08T17:08:18+00:00","commit_hash":"84a1fe8"}
{"id":"f-f97f15","title":"Add opencode agent with permission bypass ENV configuration","status":"closed","description":"Update .fuel/config.yaml opencode-glm agent to include env config for bypassing permissions.\n\nOpenCode uses OPENCODE_PERMISSION env var. Example config:\n\n```yaml\nopencode-glm:\n  command: opencode\n  prompt_args: [\"run\"]\n  model: opencode/glm-4.7-free\n  args: []\n  env:\n    OPENCODE_PERMISSION: '{\"permission\":\"allow\"}'\n  max_concurrent: 2\n  resume_args: [\"--session\"]\n```\n\nAlso add to ConfigService::createDefaultConfig() default config template.\n\nFiles: app/Services/ConfigService.php, .fuel/config.yaml","type":"feature","priority":2,"labels":[],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-10T12:01:37+00:00","updated_at":"2026-01-10T12:27:28+00:00","consume_pid":null,"consumed":true,"commit_hash":"e676d08"}
{"id":"f-f99b4e","title":"Add 'docs' as valid task type","status":"closed","description":"TaskService and AddCommand should accept 'docs' as a valid task type alongside bug, feature, task, epic, chore. Update VALID_TYPES constant and CLAUDE.md documentation.","type":"feature","priority":2,"labels":["enhancement"],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:43:41+00:00","updated_at":"2026-01-07T17:51:53+00:00","commit_hash":"2522272"}
{"id":"f-fc18a7","title":"Show agent name in ConsumeCommand status when spawning","status":"closed","description":"ConsumeCommand.php should display which agent it's using when spawning. Around line 190 where it shows 'Spawning agent for {taskId}', also show the agent name from config (e.g., 'Spawning cursor-agent for fuel-xxxx'). Get agent name from $agentCommandArray[0] or from ConfigService.","type":"feature","priority":1,"labels":["config","consume"],"size":"m","complexity":"trivial","blocked_by":[],"created_at":"2026-01-07T17:41:57+00:00","updated_at":"2026-01-07T17:51:22+00:00","consumed":true,"consumed_at":"2026-01-07T17:45:51+00:00","consume_pid":null,"consumed_exit_code":0,"consumed_output":""}
{"id":"f-fc2ad9","title":"Auto-close tasks when agent exits successfully but didn't self-report","status":"closed","description":"In ConsumeCommand, when agent exits with code 0 but task is still in_progress:\n1. Call DoneCommand logic (Artisan::call('done', [...]) or extract shared method)\n2. Add 'auto-closed' label to indicate it wasn't self-reported\n3. Board could show different icon for auto-closed tasks (ðŸ¤–?)\n\nThis is a pre-Phase 4 interim solution. Phase 4 will add proper review workflow.\n\nKey: use DoneCommand rather than duplicating logic, so future done enhancements apply automatically.","type":"feature","priority":1,"labels":[],"size":"m","complexity":"simple","blocked_by":[],"created_at":"2026-01-10T11:43:58+00:00","updated_at":"2026-01-10T11:45:33+00:00","consumed":true,"consume_pid":null,"commit_hash":"c2469c6"}
